import{bD as oe,bE as e,bF as Je,bG as xe,bH as Xe,bI as Ye,r as u,bJ as be,bK as Ze,bL as et,bM as tt,bN as st,bO as nt,bP as at,bQ as ot,bR as rt,bS as it,bT as ct,bU as _e,bV as lt}from"./vendor-d9827f45.js";import{D as we,S as v,I as Ce,P as ut,T as se,a as ht,B as re,b as dt,c as Z,d as fe,L as pt,e as gt,f as mt,g as ve,h as xt,i as _t,j as Ct,k as ft,l as vt,C as R,m as St}from"./fluentui-react-89cf9bab.js";import{e as jt,E as yt,f as bt,g as wt,D as Nt,h as Tt}from"./fluentui-icons-00833c8c.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))c(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const h of n.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&c(h)}).observe(document,{childList:!0,subtree:!0});function i(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function c(o){if(o.ep)return;o.ep=!0;const n=i(o);fetch(o.href,n)}})();async function kt(){const t=await fetch("/auth_setup");if(!t.ok)throw new Error(`auth setup response was not ok: ${t.status}`);return await t.json()}const $=await kt(),A=$.useLogin,Lt=$.msalConfig,At=$.loginRequest,Pt=$.tokenRequest,Ne=()=>window.location.origin+$.msalConfig.auth.redirectUri,It=t=>t.acquireTokenSilent({...Pt,redirectUri:Ne()}).catch(s=>{console.log(s)});const Rt="/assets/github-fab00c2d.svg",Et="_layout_1nrkm_1",Mt="_header_1nrkm_7",qt="_headerContainer_1nrkm_12",Bt="_headerTitleContainer_1nrkm_20",$t="_headerLogo_1nrkm_28",Ft="_headerTitle_1nrkm_20",Ot="_headerNavList_1nrkm_37",Gt="_headerNavPageLink_1nrkm_43",Ht="_headerNavPageLinkActive_1nrkm_57",Qt="_headerNavLeftMargin_1nrkm_62",Dt="_headerRightText_1nrkm_66",Ut="_microsoftLogo_1nrkm_71",zt="_githubLogo_1nrkm_76",_={layout:Et,header:Mt,headerContainer:qt,headerTitleContainer:Bt,headerLogo:$t,headerTitle:Ft,headerNavList:Ot,headerNavPageLink:Gt,headerNavPageLinkActive:Ht,headerNavLeftMargin:Qt,headerRightText:Dt,microsoftLogo:Ut,githubLogo:zt},Wt="_loginButton_m8yze_1",Vt={loginButton:Wt},Kt=()=>{const{instance:t}=oe(),s=t.getActiveAccount(),i=()=>{t.loginPopup({...At,redirectUri:Ne()}).catch(n=>console.log(n))},c=()=>{t.logoutPopup({mainWindowRedirectUri:"/",account:t.getActiveAccount()}).catch(n=>console.log(n))},o=`Logout
${s?.username}`;return e.jsx(we,{text:s?o:"Login",className:Vt.loginButton,onClick:s?c:i})},Se=()=>e.jsxs("div",{className:_.layout,children:[e.jsx("header",{className:_.header,role:"banner",children:e.jsxs("div",{className:_.headerContainer,children:[e.jsx(Je,{to:"/",className:_.headerTitleContainer,children:e.jsx("h3",{className:_.headerTitle,children:"GPT + Enterprise data | Sample"})}),e.jsx("nav",{children:e.jsxs("ul",{className:_.headerNavList,children:[e.jsx("li",{children:e.jsx(xe,{to:"/",className:({isActive:t})=>t?_.headerNavPageLinkActive:_.headerNavPageLink,children:"Chat"})}),e.jsx("li",{className:_.headerNavLeftMargin,children:e.jsx(xe,{to:"/qa",className:({isActive:t})=>t?_.headerNavPageLinkActive:_.headerNavPageLink,children:"Ask a question"})}),e.jsx("li",{className:_.headerNavLeftMargin,children:e.jsx("a",{href:"https://aka.ms/entgptsearch",target:"_blank",title:"Github repository link",children:e.jsx("img",{src:Rt,alt:"Github logo","aria-label":"Link to github repository",width:"20px",height:"20px",className:_.githubLogo})})})]})}),e.jsx("h4",{className:_.headerRightText,children:"Azure OpenAI + AI Search"}),A&&e.jsx(Kt,{})]})}),e.jsx(Xe,{})]}),Jt="_container_18ti9_1",Xt="_chatRoot_18ti9_8",Yt="_chatContainer_18ti9_13",Zt="_chatEmptyState_18ti9_21",es="_chatEmptyStateTitle_18ti9_31",ts="_chatEmptyStateSubtitle_18ti9_38",ss="_chatMessageStream_18ti9_54",ns="_chatMessageGpt_18ti9_66",as="_chatMessageGptMinWidth_18ti9_73",os="_chatInput_18ti9_78",rs="_chatAnalysisPanel_18ti9_91",is="_chatSettingsSeparator_18ti9_99",cs="_loadingLogo_18ti9_103",ls="_commandsContainer_18ti9_107",us="_commandButton_18ti9_112",l={container:Jt,chatRoot:Xt,chatContainer:Yt,chatEmptyState:Zt,chatEmptyStateTitle:es,chatEmptyStateSubtitle:ts,chatMessageStream:ss,chatMessageGpt:ns,chatMessageGptMinWidth:as,chatInput:os,chatAnalysisPanel:rs,chatSettingsSeparator:is,loadingLogo:cs,commandsContainer:ls,commandButton:us},ie="";function Te(t){var s={"Content-Type":"application/json"};return A&&t&&(s.Authorization=`Bearer ${t}`),s}async function ln(t,s){const i=await fetch(`${ie}/ask`,{method:"POST",headers:Te(s),body:JSON.stringify(t)}),c=await i.json();if(i.status>299||!i.ok)throw Error(c.error||"Unknown error");return c}async function hs(t,s){return await fetch(`${ie}/chat`,{method:"POST",headers:Te(s),body:JSON.stringify(t)})}function ke(t){return`${ie}/content/${t}`}var N=(t=>(t.Hybrid="hybrid",t.Vectors="vectors",t.Text="text",t))(N||{});const ds="_answerContainer_1sqax_1",ps="_answerLogo_1sqax_11",gs="_answerText_1sqax_15",ms="_selected_1sqax_34",xs="_citationLearnMore_1sqax_38",_s="_citation_1sqax_38",Cs="_followupQuestionsList_1sqax_60",fs="_followupQuestionLearnMore_1sqax_64",vs="_followupQuestion_1sqax_60",Ss="_supContainer_1sqax_83",js="_retryButton_1sqax_112",ys="_loadingdots_1sqax_134",bs="_loading_1sqax_134",C={answerContainer:ds,answerLogo:ps,answerText:gs,selected:ms,citationLearnMore:xs,citation:_s,followupQuestionsList:Cs,followupQuestionLearnMore:fs,followupQuestion:vs,supContainer:Ss,retryButton:js,loadingdots:ys,loading:bs};function ws(t,s,i){const c=[];let o=t.trim();if(s){let d=o.length;for(let g=o.length-1;g>=0&&o[g]!=="]";g--)if(o[g]==="["){d=g;break}o=o.substring(0,d)}return{answerHtml:o.split(/\[([^\]]+)\]/g).map((d,f)=>{if(f%2===0)return d;{let g;c.indexOf(d)!==-1?g=c.indexOf(d)+1:(c.push(d),g=c.length);const p=ke(d);return Ye(e.jsx("a",{className:"supContainer",title:d,onClick:()=>i(p),children:e.jsx("sup",{children:g})}))}}).join(""),citations:c}}const Le=()=>e.jsx(jt,{primaryFill:"rgba(115, 118, 225, 1)","aria-hidden":"true","aria-label":"Answer logo"}),je=({answer:t,isSelected:s,isStreaming:i,onCitationClicked:c,onThoughtProcessClicked:o,onSupportingContentClicked:n,onFollowupQuestionClicked:h,showFollowupQuestions:d})=>{const f=t.choices[0].context.followup_questions,g=t.choices[0].message.content,p=u.useMemo(()=>ws(g,i,c),[t]),T=be.sanitize(p.answerHtml);return e.jsxs(v,{className:`${C.answerContainer} ${s&&C.selected}`,verticalAlign:"space-between",children:[e.jsx(v.Item,{children:e.jsxs(v,{horizontal:!0,horizontalAlign:"space-between",children:[e.jsx(Le,{}),e.jsxs("div",{children:[e.jsx(Ce,{style:{color:"black"},iconProps:{iconName:"Lightbulb"},title:"Show thought process",ariaLabel:"Show thought process",onClick:()=>o(),disabled:!t.choices[0].context.thoughts?.length}),e.jsx(Ce,{style:{color:"black"},iconProps:{iconName:"ClipboardList"},title:"Show supporting content",ariaLabel:"Show supporting content",onClick:()=>n(),disabled:!t.choices[0].context.data_points?.length})]})]})}),e.jsx(v.Item,{grow:!0,children:e.jsx("div",{className:C.answerText,dangerouslySetInnerHTML:{__html:T}})}),!!p.citations.length&&e.jsx(v.Item,{children:e.jsxs(v,{horizontal:!0,wrap:!0,tokens:{childrenGap:5},children:[e.jsx("span",{className:C.citationLearnMore,children:"Citations:"}),p.citations.map((y,P)=>{const F=ke(y);return e.jsx("a",{className:C.citation,title:y,onClick:()=>c(F),children:`${++P}. ${y}`},P)})]})}),!!f?.length&&d&&h&&e.jsx(v.Item,{children:e.jsxs(v,{horizontal:!0,wrap:!0,className:`${p.citations.length?C.followupQuestionsList:""}`,tokens:{childrenGap:6},children:[e.jsx("span",{className:C.followupQuestionLearnMore,children:"Follow-up questions:"}),f.map((y,P)=>e.jsx("a",{className:C.followupQuestion,title:y,onClick:()=>h(y),children:`${y}`},P))]})})]})},Ns=()=>{const t=Ze({from:{opacity:0},to:{opacity:1}});return e.jsx(et.div,{style:{...t},children:e.jsxs(v,{className:C.answerContainer,verticalAlign:"space-between",children:[e.jsx(Le,{}),e.jsx(v.Item,{grow:!0,children:e.jsxs("p",{className:C.answerText,children:["Generating answer",e.jsx("span",{className:C.loadingdots})]})})]})})},Ts=({error:t,onRetry:s})=>e.jsxs(v,{className:C.answerContainer,verticalAlign:"space-between",children:[e.jsx(yt,{"aria-hidden":"true","aria-label":"Error icon",primaryFill:"red"}),e.jsx(v.Item,{grow:!0,children:e.jsx("p",{className:C.answerText,children:t})}),e.jsx(ut,{className:C.retryButton,onClick:s,text:"Retry"})]}),ks="_questionInputContainer_hiipw_1",Ls="_questionInputTextArea_hiipw_12",As="_questionInputButtonsContainer_hiipw_17",ee={questionInputContainer:ks,questionInputTextArea:Ls,questionInputButtonsContainer:As},Ps=({onSend:t,disabled:s,placeholder:i,clearOnSend:c})=>{const[o,n]=u.useState(""),h=()=>{s||!o.trim()||(t(o),c&&n(""))},d=p=>{p.key==="Enter"&&!p.shiftKey&&(p.preventDefault(),h())},f=(p,T)=>{T?T.length<=1e3&&n(T):n("")},g=s||!o.trim();return e.jsxs(v,{horizontal:!0,className:ee.questionInputContainer,children:[e.jsx(se,{className:ee.questionInputTextArea,placeholder:i,multiline:!0,resizable:!1,borderless:!0,value:o,onChange:f,onKeyDown:d}),e.jsx("div",{className:ee.questionInputButtonsContainer,children:e.jsx(ht,{content:"Ask question button",relationship:"label",children:e.jsx(re,{size:"large",icon:e.jsx(bt,{primaryFill:"rgba(115, 118, 225, 1)"}),disabled:g,onClick:h})})})]})},Is="_examplesNavList_1xtxw_1",Rs="_example_1xtxw_1",Es="_exampleText_1xtxw_29",ne={examplesNavList:Is,example:Rs,exampleText:Es},Ms=({text:t,value:s,onClick:i})=>e.jsx("div",{className:ne.example,onClick:()=>i(s),children:e.jsx("p",{className:ne.exampleText,children:t})}),qs=[{text:"What is included in my Northwind Health Plus plan that is not in standard?",value:"What is included in my Northwind Health Plus plan that is not in standard?"},{text:"What happens in a performance review?",value:"What happens in a performance review?"},{text:"What does a Product Manager do?",value:"What does a Product Manager do?"}],Bs=({onExampleClicked:t})=>e.jsx("ul",{className:ne.examplesNavList,children:qs.map((s,i)=>e.jsx("li",{children:e.jsx(Ms,{text:s.text,value:s.value,onClick:t})},i))}),$s="_container_1p3pb_1",Fs="_message_1p3pb_9",ye={container:$s,message:Fs},z=({message:t})=>e.jsx("div",{className:ye.container,children:e.jsx("div",{className:ye.message,children:t})}),Os="_thoughtProcess_1rdxk_1",Gs={thoughtProcess:Os};function Hs(t){const s=t.split(": "),i=s[0],c=s.slice(1).join(": ");return{title:i,content:c}}const Qs="_supportingContentNavList_gbiaw_1",Ds="_supportingContentItem_gbiaw_9",Us="_supportingContentItemHeader_gbiaw_23",zs="_supportingContentItemText_gbiaw_27",W={supportingContentNavList:Qs,supportingContentItem:Ds,supportingContentItemHeader:Us,supportingContentItemText:zs},Ws=({supportingContent:t})=>e.jsx("ul",{className:W.supportingContentNavList,children:t.map((s,i)=>{const c=Hs(s);return e.jsxs("li",{className:W.supportingContentItem,children:[e.jsx("h4",{className:W.supportingContentItemHeader,children:c.title}),e.jsx("p",{className:W.supportingContentItemText,children:c.content})]})})});var b=(t=>(t.ThoughtProcessTab="thoughtProcess",t.SupportingContentTab="supportingContent",t.CitationTab="citation",t))(b||{});const te={disabled:!0,style:{color:"grey"}},Vs=({answer:t,activeTab:s,activeCitation:i,citationHeight:c,className:o,onActiveTabChanged:n})=>{const h=!t.choices[0].context.thoughts,d=!t.choices[0].context.data_points.length,f=!i,g=be.sanitize(t.choices[0].context.thoughts);return e.jsxs(dt,{className:o,selectedKey:s,onLinkClick:p=>p&&n(p.props.itemKey),children:[e.jsx(Z,{itemKey:b.ThoughtProcessTab,headerText:"Thought process",headerButtonProps:h?te:void 0,children:e.jsx("div",{className:Gs.thoughtProcess,dangerouslySetInnerHTML:{__html:g}})}),e.jsx(Z,{itemKey:b.SupportingContentTab,headerText:"Supporting content",headerButtonProps:d?te:void 0,children:e.jsx(Ws,{supportingContent:t.choices[0].context.data_points})}),e.jsx(Z,{itemKey:b.CitationTab,headerText:"Citation",headerButtonProps:f?te:void 0,children:e.jsx("iframe",{title:"Citation",src:i,width:"100%",height:c})})]})},Ks="_container_cfwv2_1",Js={container:Ks},Xs=({className:t,onClick:s})=>e.jsx("div",{className:`${Js.container} ${t??""}`,children:e.jsx(re,{icon:e.jsx(wt,{}),onClick:s,children:"Developer settings"})}),Ys="_container_cfwv2_1",Zs={container:Ys},en=({className:t,disabled:s,onClick:i})=>e.jsx("div",{className:`${Zs.container} ${t??""}`,children:e.jsx(re,{icon:e.jsx(Nt,{}),disabled:s,onClick:i,children:"Clear chat"})}),tn=()=>{const{instance:t}=oe(),s=t.getActiveAccount(),i=n=>typeof n=="string"?n:JSON.stringify(n),c=s?.idTokenClaims?Object.keys(s.idTokenClaims).map(n=>({name:n,value:i((s.idTokenClaims??{})[n])})):[],o=[fe({columnId:"name",compare:(n,h)=>n.name.localeCompare(h.name),renderHeaderCell:()=>"Name",renderCell:n=>n.name}),fe({columnId:"value",compare:(n,h)=>n.value.localeCompare(h.value),renderHeaderCell:()=>"Value",renderCell:n=>n.value})];return e.jsxs("div",{children:[e.jsx(pt,{children:"ID Token Claims"}),e.jsxs(gt,{items:c,columns:o,sortable:!0,getRowId:n=>n.name,children:[e.jsx(mt,{children:e.jsx(ve,{children:({renderHeaderCell:n})=>e.jsx(xt,{children:n()})})}),e.jsx(_t,{children:({item:n,rowId:h})=>e.jsx(ve,{children:({renderCell:d})=>e.jsx(Ct,{children:d(n)})},h)})]})]})},sn=()=>{const[t,s]=u.useState(!1),[i,c]=u.useState(""),[o,n]=u.useState(3),[h,d]=u.useState(N.Hybrid),[f,g]=u.useState(!0),[p,T]=u.useState(!0),[y,P]=u.useState(!1),[F,Ae]=u.useState(""),[O,Pe]=u.useState(!1),[ce,Ie]=u.useState(!1),[le,Re]=u.useState(!1),k=u.useRef(""),V=u.useRef(null),[G,H]=u.useState(!1),[ue,K]=u.useState(!1),[Q,J]=u.useState(),[he,X]=u.useState(),[E,I]=u.useState(void 0),[M,de]=u.useState(0),[S,D]=u.useState([]),[pe,ge]=u.useState([]),Ee=async(r,a,j,Y)=>{let w="",m={};const We=x=>new Promise(Ve=>{setTimeout(()=>{w+=x;const Ke={...m,choices:[{...m.choices[0],message:{content:w,role:m.choices[0].message.role}}]};ge([...a,[r,Ke]]),Ve(null)},33)});try{K(!0);for await(const x of tt(Y))if(x.choices&&x.choices[0].context&&x.choices[0].context.data_points)x.choices[0].message=x.choices[0].delta,m=x;else if(x.choices&&x.choices[0].delta.content)H(!1),await We(x.choices[0].delta.content);else if(x.choices&&x.choices[0].context)m.choices[0].context={...m.choices[0].context,...x.choices[0].context};else if(x.error)throw Error(x.error)}finally{K(!1)}return{...m,choices:[{...m.choices[0],message:{content:w,role:m.choices[0].message.role}}]}},U=A?oe().instance:void 0,q=async r=>{k.current=r,Q&&J(void 0),H(!0),X(void 0),I(void 0);const a=U?await It(U):void 0;try{const Y={messages:[...S.flatMap(m=>[{content:m[0],role:"user"},{content:m[1].choices[0].message.content,role:"assistant"}]),{content:r,role:"user"}],stream:p,context:{overrides:{prompt_template:i.length===0?void 0:i,exclude_category:F.length===0?void 0:F,top:o,retrieval_mode:h,semantic_ranker:f,semantic_captions:y,suggest_followup_questions:O,use_oid_security_filter:ce,use_groups_security_filter:le}},session_state:S.length?S[S.length-1][1].choices[0].session_state:null},w=await hs(Y,a?.accessToken);if(!w.body)throw Error("No response body");if(p){const m=await Ee(r,S,D,w.body);D([...S,[r,m]])}else{const m=await w.json();if(w.status>299||!w.ok)throw Error(m.error||"Unknown error");D([...S,[r,m]])}}catch(j){J(j)}finally{H(!1)}},Me=()=>{k.current="",Q&&J(void 0),X(void 0),I(void 0),D([]),ge([]),H(!1),K(!1)};u.useEffect(()=>V.current?.scrollIntoView({behavior:"smooth"}),[G]),u.useEffect(()=>V.current?.scrollIntoView({behavior:"auto"}),[pe]);const qe=(r,a)=>{c(a||"")},Be=(r,a)=>{n(parseInt(a||"3"))},$e=(r,a,j)=>{d(a?.data||N.Hybrid)},Fe=(r,a)=>{g(!!a)},Oe=(r,a)=>{P(!!a)},Ge=(r,a)=>{T(!!a)},He=(r,a)=>{Ae(a||"")},Qe=(r,a)=>{Pe(!!a)},De=(r,a)=>{Ie(!!a)},Ue=(r,a)=>{Re(!!a)},ze=r=>{q(r)},me=(r,a)=>{he===r&&E===b.CitationTab&&M===a?I(void 0):(X(r),I(b.CitationTab)),de(a)},B=(r,a)=>{I(E===r&&M===a?void 0:r),de(a)};return e.jsxs("div",{className:l.container,children:[e.jsxs("div",{className:l.commandsContainer,children:[e.jsx(en,{className:l.commandButton,onClick:Me,disabled:!k.current||G}),e.jsx(Xs,{className:l.commandButton,onClick:()=>s(!t)})]}),e.jsxs("div",{className:l.chatRoot,children:[e.jsxs("div",{className:l.chatContainer,children:[k.current?e.jsxs("div",{className:l.chatMessageStream,children:[ue&&pe.map((r,a)=>e.jsxs("div",{children:[e.jsx(z,{message:r[0]}),e.jsx("div",{className:l.chatMessageGpt,children:e.jsx(je,{isStreaming:!0,answer:r[1],isSelected:!1,onCitationClicked:j=>me(j,a),onThoughtProcessClicked:()=>B(b.ThoughtProcessTab,a),onSupportingContentClicked:()=>B(b.SupportingContentTab,a),onFollowupQuestionClicked:j=>q(j),showFollowupQuestions:O&&S.length-1===a},a)})]},a)),!ue&&S.map((r,a)=>e.jsxs("div",{children:[e.jsx(z,{message:r[0]}),e.jsx("div",{className:l.chatMessageGpt,children:e.jsx(je,{isStreaming:!1,answer:r[1],isSelected:M===a&&E!==void 0,onCitationClicked:j=>me(j,a),onThoughtProcessClicked:()=>B(b.ThoughtProcessTab,a),onSupportingContentClicked:()=>B(b.SupportingContentTab,a),onFollowupQuestionClicked:j=>q(j),showFollowupQuestions:O&&S.length-1===a},a)})]},a)),G&&e.jsxs(e.Fragment,{children:[e.jsx(z,{message:k.current}),e.jsx("div",{className:l.chatMessageGptMinWidth,children:e.jsx(Ns,{})})]}),Q?e.jsxs(e.Fragment,{children:[e.jsx(z,{message:k.current}),e.jsx("div",{className:l.chatMessageGptMinWidth,children:e.jsx(Ts,{error:Q.toString(),onRetry:()=>q(k.current)})})]}):null,e.jsx("div",{ref:V})]}):e.jsxs("div",{className:l.chatEmptyState,children:[e.jsx(Tt,{fontSize:"120px",primaryFill:"rgba(115, 118, 225, 1)","aria-hidden":"true","aria-label":"Chat logo"}),e.jsx("h1",{className:l.chatEmptyStateTitle,children:"Chat with your data"}),e.jsx("h2",{className:l.chatEmptyStateSubtitle,children:"Ask anything or try an example"}),e.jsx(Bs,{onExampleClicked:ze})]}),e.jsx("div",{className:l.chatInput,children:e.jsx(Ps,{clearOnSend:!0,placeholder:"Type a new question (e.g. does my plan cover annual eye exams?)",disabled:G,onSend:r=>q(r)})})]}),S.length>0&&E&&e.jsx(Vs,{className:l.chatAnalysisPanel,activeCitation:he,onActiveTabChanged:r=>B(r,M),citationHeight:"810px",answer:S[M][1],activeTab:E}),e.jsxs(ft,{headerText:"Configure answer generation",isOpen:t,isBlocking:!1,onDismiss:()=>s(!1),closeButtonAriaLabel:"Close",onRenderFooterContent:()=>e.jsx(we,{onClick:()=>s(!1),children:"Close"}),isFooterAtBottom:!0,children:[e.jsx(se,{className:l.chatSettingsSeparator,defaultValue:i,label:"Override prompt template",multiline:!0,autoAdjustHeight:!0,onChange:qe}),e.jsx(vt,{className:l.chatSettingsSeparator,label:"Retrieve this many search results:",min:1,max:50,defaultValue:o.toString(),onChange:Be}),e.jsx(se,{className:l.chatSettingsSeparator,label:"Exclude category",onChange:He}),e.jsx(R,{className:l.chatSettingsSeparator,checked:f,label:"Use semantic ranker for retrieval",onChange:Fe}),e.jsx(R,{className:l.chatSettingsSeparator,checked:y,label:"Use query-contextual summaries instead of whole documents",onChange:Oe,disabled:!f}),e.jsx(R,{className:l.chatSettingsSeparator,checked:O,label:"Suggest follow-up questions",onChange:Qe}),A&&e.jsx(R,{className:l.chatSettingsSeparator,checked:ce,label:"Use oid security filter",disabled:!U?.getActiveAccount(),onChange:De}),A&&e.jsx(R,{className:l.chatSettingsSeparator,checked:le,label:"Use groups security filter",disabled:!U?.getActiveAccount(),onChange:Ue}),e.jsx(St,{className:l.chatSettingsSeparator,label:"Retrieval mode",options:[{key:"hybrid",text:"Vectors + Text (Hybrid)",selected:h==N.Hybrid,data:N.Hybrid},{key:"vectors",text:"Vectors",selected:h==N.Vectors,data:N.Vectors},{key:"text",text:"Text",selected:h==N.Text,data:N.Text}],required:!0,onChange:$e}),e.jsx(R,{className:l.chatSettingsSeparator,checked:p,label:"Stream chat completion responses",onChange:Ge}),A&&e.jsx(tn,{})]})]})]})};var ae;if(A){var L=new st(Lt);!L.getActiveAccount()&&L.getAllAccounts().length>0&&L.setActiveAccount(L.getActiveAccount()),L.addEventCallback(t=>{if(t.eventType===nt.LOGIN_SUCCESS&&t.payload){const s=t.payload;L.setActiveAccount(s)}}),ae=e.jsx(lt,{instance:L,children:e.jsx(Se,{})})}else ae=e.jsx(Se,{});at();const nn=ot([{path:"/",element:ae,children:[{index:!0,element:e.jsx(sn,{})},{path:"qa",lazy:()=>_e(()=>import("./OneShot-f764a36f.js"),["assets/OneShot-f764a36f.js","assets/vendor-d9827f45.js","assets/fluentui-react-89cf9bab.js","assets/fluentui-icons-00833c8c.js","assets/OneShot-daa12333.css"])},{path:"*",lazy:()=>_e(()=>import("./NoPage-801aeb3c.js"),["assets/NoPage-801aeb3c.js","assets/vendor-d9827f45.js"])}]}]);rt.createRoot(document.getElementById("root")).render(e.jsx(it.StrictMode,{children:e.jsx(ct,{router:nn})}));export{je as A,Bs as E,Ps as Q,N as R,Xs as S,tn as T,b as a,Ts as b,Vs as c,ln as d,It as g,A as u};
//# sourceMappingURL=index-dc1d013e.js.map
